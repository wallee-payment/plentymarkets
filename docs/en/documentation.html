<!DOCTYPE html>
<html lang="en">
	<head>
		<meta charset="utf-8">
		<meta http-equiv="X-UA-Compatible" content="IE=edge">
		<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
		<meta name="keywords" value="wallee, plentymarkets, plentymarkets Extension, Payment, Payment Integration, Documentation"><meta name="description" value="The documentation for the plentymarkets extension that enables processing payments with wallee.">		
		<link rel="canonical" href="@WalleeCanonicalPath(https://plugin-documentation.wallee.com/wallee-payment, docs/en/documentation.html)" />
		<title>wallee plentymarkets</title>
		<link href="assets/monokai-sublime.css" rel="stylesheet" />
		<link href="assets/base.css" rel="stylesheet" />
	</head>
	<body class="documentation">
		<div class="layout-wrapper">
							<div class="layout-title">
					<h1>wallee plentymarkets</h1>
<h2>Documentation</h2>				</div>
										<div class="layout-navigation">
					<ul class="nav">
	<li>
		<a href="https://app-wallee.com/user/signup">
			Sign Up
		</a>
	</li>
	<li>
		<a href="@WalleeReleasePath()">
			Source
		</a>
	</li>
</ul>				</div>
										<div class="layout-content">
												<div class="col-body">
							<div class="col-body-wrapper">
																	<div class="body-container">
																						<div class="chapter" id="_prerequisites">
	<div class="chapter-title">
		<h1>
			<span class="title-number">1</span>Prerequisites					</h1>
	</div>
	<div class="chapter-body">
					<div class="paragraph">
<p>If you don&#8217;t already have one, create a <a href="https://app-wallee.com/user/signup/">wallee</a> account.</p>
</div><div class="paragraph">
<p>Please note in order to install this plugin you will have to use <a href="https://marketplace.plentymarkets.com/plugins/channels/online-shops/ceres_4697" target="_blank">Ceres</a> (the default template plugin for plentymarkets 7 online stores) and the <a href="https://marketplace.plentymarkets.com/plugins/channels/online-shops/io_4696" target="_blank">IO plugin</a> (required to run the plentymarkets Ceres plugin).</p>
</div>					</div>
</div>	<div class="chapter" id="_installation">
	<div class="chapter-title">
		<h1>
			<span class="title-number">2</span>Installation					</h1>
	</div>
	<div class="chapter-body">
					<div class="olist arabic">
<ol class="arabic">
<li>
<p>Install the plugin directly from the <a href="https://marketplace.plentymarkets.com/plugins/payment/wallee_5038" target="_blank">plentyMarketplace</a> or via <a href="https://github.com/wallee-payment/plentymarkets" target="_blank">GitHub</a>. Check out <a href="https://knowledge.plentymarkets.com/en/plugins/adding-plugins-system" target="_blank">plentyKnowledge</a> on how to install plugins.</p>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
The advantage of installing the plugin via the github is that this version will always be up to date. The release pipeline through the official plentymarkets pipeline is generally slower.
</td>
</tr>
</table>
</div>
</li>
<li>
<p>Log in to the backend of your plentymarkets store.</p>
</li>
<li>
<p>Navigate to Plugins. Search for the 'Not installed plugins' and click on the <code>Install</code> button of the plugin to install it.</p>
</li>
<li>
<p>Activate the wallee Payment plugin using the 'Active/Not active' button.</p>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
In case you need to update the plugin, see our <a href="#_faq">FAQ</a> about the update process.
</td>
</tr>
</table>
</div>
</li>
</ol>
</div>					</div>
</div>	<div class="chapter" id="_configuration">
	<div class="chapter-title">
		<h1>
			<span class="title-number">3</span>Configuration					</h1>
	</div>
	<div class="chapter-body">
					<div class="olist arabic">
<ol class="arabic">
<li>
<p>Navigate to Plugins &gt; Installed plugins in your plentymarkets backend, click on the plugin to open the configuration and enter the wallee Space ID, User ID and Authentication Key that you can create an <a href="https://app-wallee.com/en-us/doc/permission-concept#_create_application_users" target="_blank">application user</a>.</p>
<div class="paragraph">
<p>If your store is configured for multishop, you may use different spaces for each store to configure different behaviours.</p>
</div>
</li>
<li>
<p>Optionally disable downloading invoice and packing slip. These settings allow customers to download the documents from their order overview in the plentymarkets frontend.</p>
</li>
<li>
<p>After saving the configuration necessary webhooks are set up.</p>
</li>
</ol>
</div><div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
Please note that state changes take time as
plentymarkets is updating the order state every 15 mins only.
</td>
</tr>
</table>
</div><div class="olist arabic">
<ol class="arabic">
<li>
<p>Activate the payment methods that you want to use.</p>
</li>
<li>
<p>In case the payment methods are not visible in the checkout make sure that you enable the payment methods for
your customer groups.</p>
</li>
</ol>
</div><div class="paragraph">
<p>The main configuration is now finished. You should see the payment methods in your checkout. To view the payment methods configuration in the backend of plentymarkets go to Plugins &gt; wallee.</p>
</div>					</div>
</div>	<div class="chapter" id="_payment_method_configuration">
	<div class="chapter-title">
		<h1>
			<span class="title-number">4</span>Payment method configuration					</h1>
	</div>
	<div class="chapter-body">
							<div class="section" id="_setup">
	<div class="section-title">
		<h2>
			<span class="title-number">4.1</span>Setup					</h2>
	</div>
	<div class="section-body">
					<div class="paragraph">
<p>Once you have added the payment methods and connectors in your wallee space, you simply need to activate them in your plentymarkets store backend under Plugins &gt; wallee.</p>
</div>					</div>
</div>					<div class="section" id="_customization">
	<div class="section-title">
		<h2>
			<span class="title-number">4.2</span>Customization					</h2>
	</div>
	<div class="section-body">
					<div class="paragraph">
<p>Due to limitations in Plentymarkets, the payment method icons are unable to be updated</p>
</div>					</div>
</div>			</div>
</div>	<div class="chapter" id="_state_graph">
	<div class="chapter-title">
		<h1>
			<span class="title-number">5</span>State graph					</h1>
	</div>
	<div class="chapter-body">
					<div class="paragraph">
<p>The Payment Process of wallee is <strong>completely standardized for every payment method</strong> you can process. This gives you the ability to simply add
a payment method or processor without changes inside of your plentymarkets configuration. An overview about the states and the payment processes of wallee
can be found in the <a href="https://app-wallee.com/en-us/doc/payment/transaction-process" target="_blank">Payment Documentation</a>.</p>
</div><div class="paragraph">
<p>In the following section we provide you an overview about how the wallee states are mapped into the plentymarkets State graph for orders and payment states.</p>
</div>							<div class="section" id="_state_mapping_of_plentymarkets_orders">
	<div class="section-title">
		<h2>
			<span class="title-number">5.1</span>State mapping of plentymarkets orders					</h2>
	</div>
	<div class="section-body">
					<div class="paragraph">
<p>Below you find a diagram that shows the state machine of plentymarkets for orders including additional information for the state transitions.</p>
</div><div class="imageblock">
<div class="content">
<img src="resource/state_graph.svg" alt="state graph"/>
</div>
</div><div class="olist glossary">
<ol class="glossary">
<li>
<p>If the transaction is <code>pending</code> or <code>authorized</code>  in wallee, the plentymarkets order is marked as <code>[3] Waiting for payment</code>. Please note that the state changes can take up to 15 mins as plentymarkets is fechting the orders in
this interval.</p>
</li>
<li>
<p>If the transaction fails during the authorization process, the plentymarkets order is either marked as <code>[8] Canceled</code>.</p>
</li>
<li>
<p>If the transaction in wallee is marked as <code>fulfill</code>, the plentymarkets order is marked as <code>[5] Cleared for shipping</code>, indicating that it can now be fulfilled.</p>
</li>
<li>
<p>If the transaction&#8217;s authorization is voided or the risk assessments indicate that the order should not be fulfilled, the order is marked as <code>[5] Canceled</code>.</p>
</li>
</ol>
</div>							<div class="section" id="_general_remarks_regarding_order_statuses">
	<div class="section-title">
		<h3>
			<span class="title-number">5.1.1</span>General remarks regarding order statuses					</h3>
	</div>
	<div class="section-body">
					<div class="paragraph">
<p>We recommend that you only change the order status to indicate that shipping has taken place. If you change it before the transaction has reached a final state in wallee, the plugin may changed the order status again. If you want different order statuses to be set, you can change the behaviour in the plugin configuration.</p>
</div>					</div>
</div>			</div>
</div>					<div class="section" id="_state_mapping_of_plentymarkets_payment_status">
	<div class="section-title">
		<h2>
			<span class="title-number">5.2</span>State mapping of plentymarkets payment status					</h2>
	</div>
	<div class="section-body">
					<div class="paragraph">
<p>Below you find a diagram that shows the state machine of plentymarkets for payment status including additional information for the state transitions.</p>
</div><div class="imageblock">
<div class="content">
<img src="resource/state_graph_payment_status.svg" alt="state graph payment status"/>
</div>
</div><div class="olist glossary">
<ol class="glossary">
<li>
<p>If the transaction in wallee is <code>authorized</code>, the payment status of the plentymarkets order is set to <code>awaiting confirmation</code>.</p>
</li>
<li>
<p>If the transaction fails during the authorization process, the payment status of the plentymarkets order is set to <code>canceled</code>.</p>
</li>
<li>
<p>If the transaction&#8217;s authorization is voided, the payment status of the plentymarkets order is set to <code>canceled</code>.</p>
</li>
<li>
<p>Once the invoice is paid, the payment status of the plentymarkets order is set to <code>Confirmed</code>. This also applies if the invoice is not traceable due to external administration.</p>
</li>
</ol>
</div>					</div>
</div>			</div>
</div>	<div class="chapter" id="_transaction_management">
	<div class="chapter-title">
		<h1>
			<span class="title-number">6</span>Transaction management					</h1>
	</div>
	<div class="chapter-body">
							<div class="section" id="_refund_of_a_transaction">
	<div class="section-title">
		<h2>
			<span class="title-number">6.1</span>Refund of a transaction					</h2>
	</div>
	<div class="section-body">
					<div class="paragraph">
<p>This requires to set the status ID for refunds in the plentymarkets shop configuration. Once the order is moved into that status the refund will be triggered and synchronized with wallee.</p>
</div><div class="paragraph">
<p>In order to do so please follow the steps below in the backend of your plentymarkets store:</p>
</div><div class="paragraph">
<p>First you have to create an <strong>Event procedure</strong> for a status change. This can be done under System settings &gt; Orders &gt; Events:</p>
</div><div class="olist arabic">
<ol class="arabic">
<li>
<p>There you can create an event using the + button, give it a name and select the status change that should trigger the action (in our example below <code>[11.1] Credit note disbursed</code>).</p>
</li>
<li>
<p>Within this event, you should then create a procedure and select the action under the folder <strong>Plugins</strong> where you should find an action called <code>Refund of the wallee payment</code>.</p>
</li>
<li>
<p>Store the configuration using the save button.</p>
</li>
</ol>
</div><div class="imageblock">
<div class="content">
<img src="resource/plentyMarkets-refund-event-procedure.png" alt="plentyMarkets refund event procedure"/>
</div>
</div><div class="paragraph">
<p>Once this is done, you can either create a return or a credit note for your orders following the below steps:</p>
</div><div class="olist arabic">
<ol class="arabic">
<li>
<p>Open the order and select the action either create a return or a credit note.</p>
</li>
<li>
<p>Select the products for which you want to do a return or a credit note.</p>
</li>
<li>
<p>By clicking on the save button it will create a return/credit note for your order.</p>
</li>
<li>
<p>Move the status of the return/credit note into the state that you have configured in the event procedure as explained above. This will now automatically synchronize the refund with wallee.</p>
</li>
</ol>
</div><div class="imageblock">
<div class="content">
<img src="resource/plentyMarkets-refund.png" alt="plentyMarkets refund"/>
</div>
</div>					</div>
</div>			</div>
</div>	<div class="chapter" id="_email_setup">
	<div class="chapter-title">
		<h1>
			<span class="title-number">7</span>Email Setup					</h1>
	</div>
	<div class="chapter-body">
					<div class="paragraph">
<p>As an order is being created in plentymarkets before the customer is redirected to the payment page, the <strong>order confirmation email</strong> should not be sent at the moment of the order creation.
This should be done using an Event procedure that will automatically trigger the confirmation email once the order is fulfilled.</p>
</div><div class="paragraph">
<p>In order to do so please follow the steps below in the backend of your plentymarkets store:</p>
</div><div class="paragraph">
<p>First you have to deactivate the automatic email for order creation. This can be done under System settings &gt; Standard Shop &gt; Email &gt; Automatic:
There you should set <strong>New order from online store</strong> to <strong>do not send</strong>.</p>
</div><div class="imageblock">
<div class="content">
<img src="resource/new_order_from_online_store.png" alt="new order from online store"/>
</div>
</div><div class="paragraph">
<p>Once this is done, you should create an <strong>Event procedure</strong> for payment. This can be done under System settings &gt; Orders &gt; Events:</p>
</div><div class="olist arabic">
<ol class="arabic">
<li>
<p>There you can create an event using the + button and select the event Payment &gt; Complete.</p>
</li>
<li>
<p>Within this event, you should create a filter for the wallee payment methods.</p>
</li>
<li>
<p>You should also create a procedure, select the action under the folder <strong>Customer</strong> where you should find an action called <code>Send email</code> and add the email template <code>Order: Incoming payment complete</code>.</p>
</li>
</ol>
</div><div class="imageblock">
<div class="content">
<img src="resource/event_procedure_payment.png" alt="event procedure payment"/>
</div>
</div>					</div>
</div>	<div class="chapter" id="_faq">
	<div class="chapter-title">
		<h1>
			<span class="title-number">8</span>FAQ					</h1>
	</div>
	<div class="chapter-body">
							<div class="section" id="_how_can_i_update_the_whitelabelname_plugin_in_my_store">
	<div class="section-title">
		<h2>
			<span class="title-number">8.1</span>How can I update the wallee plugin in my store?					</h2>
	</div>
	<div class="section-body">
					<div class="paragraph">
<p>To update the plugin in your plentymarkets store, simply follow the below steps:</p>
</div><div class="olist arabic">
<ol class="arabic">
<li>
<p>Press the update button in your plentymarkets store backend under Plugins &gt; wallee.</p>
</li>
<li>
<p>Save and publish the plugin set.</p>
</li>
</ol>
</div>					</div>
</div>					<div class="section" id="_how_to_prevent_paypal_payments_processed_through_whitelabelname_from_being_registered_twice">
	<div class="section-title">
		<h2>
			<span class="title-number">8.2</span>How to prevent PayPal payments processed through wallee from being registered twice?					</h2>
	</div>
	<div class="section-body">
					<div class="paragraph">
<p>You can configure the plentymarkets PayPal import to ignore wallee payments.</p>
</div><div class="olist arabic">
<ol class="arabic">
<li>
<p>In the plentymarkets store backend, navigate to Setup &gt; Orders &gt; Payment &gt; Incoming.</p>
</li>
<li>
<p>Set <strong>Ignore wallee PayPal transactions</strong> to <strong>Yes</strong>.</p>
</li>
</ol>
</div>					</div>
</div>			</div>
</div>	<div class="chapter" id="_support">
	<div class="chapter-title">
		<h1>
			<span class="title-number">9</span>Support					</h1>
	</div>
	<div class="chapter-body">
					<div class="paragraph">
<p>If you need help, feel free to contact our <a href="https://app-wallee.com/space/select?target=/support">support</a>.</p>
</div>					</div>
</div>																			</div>
															</div>
						</div>
						<div class="col-right">
		<div class="col-right-wrapper">
							<div class="table-of-contents">
	<ul class="nav">
					<li class="nav-level-1">
	<a href="#_prerequisites">
		<span class="item-number">1</span>
		<span class="item-title">Prerequisites</span>
			</a>
    </li>					<li class="nav-level-1">
	<a href="#_installation">
		<span class="item-number">2</span>
		<span class="item-title">Installation</span>
			</a>
    </li>					<li class="nav-level-1">
	<a href="#_configuration">
		<span class="item-number">3</span>
		<span class="item-title">Configuration</span>
			</a>
    </li>					<li class="nav-level-1">
	<a href="#_payment_method_configuration">
		<span class="item-number">4</span>
		<span class="item-title">Payment method configuration</span>
			</a>
        	<ul  class="nav">
    		    			<li class="nav-level-2">
	<a href="#_setup">
		<span class="item-number">4.1</span>
		<span class="item-title">Setup</span>
			</a>
    </li>    		    			<li class="nav-level-2">
	<a href="#_customization">
		<span class="item-number">4.2</span>
		<span class="item-title">Customization</span>
			</a>
    </li>    		    	</ul>
    </li>					<li class="nav-level-1">
	<a href="#_state_graph">
		<span class="item-number">5</span>
		<span class="item-title">State graph</span>
			</a>
        	<ul  class="nav">
    		    			<li class="nav-level-2">
	<a href="#_state_mapping_of_plentymarkets_orders">
		<span class="item-number">5.1</span>
		<span class="item-title">State mapping of plentymarkets orders</span>
			</a>
        	<ul  class="nav">
    		    			<li class="nav-level-3">
	<a href="#_general_remarks_regarding_order_statuses">
		<span class="item-number">5.1.1</span>
		<span class="item-title">General remarks regarding order statuses</span>
			</a>
    </li>    		    	</ul>
    </li>    		    			<li class="nav-level-2">
	<a href="#_state_mapping_of_plentymarkets_payment_status">
		<span class="item-number">5.2</span>
		<span class="item-title">State mapping of plentymarkets payment status</span>
			</a>
    </li>    		    	</ul>
    </li>					<li class="nav-level-1">
	<a href="#_transaction_management">
		<span class="item-number">6</span>
		<span class="item-title">Transaction management</span>
			</a>
        	<ul  class="nav">
    		    			<li class="nav-level-2">
	<a href="#_refund_of_a_transaction">
		<span class="item-number">6.1</span>
		<span class="item-title">Refund of a transaction</span>
			</a>
    </li>    		    	</ul>
    </li>					<li class="nav-level-1">
	<a href="#_email_setup">
		<span class="item-number">7</span>
		<span class="item-title">Email Setup</span>
			</a>
    </li>					<li class="nav-level-1">
	<a href="#_faq">
		<span class="item-number">8</span>
		<span class="item-title">FAQ</span>
			</a>
        	<ul  class="nav">
    		    			<li class="nav-level-2">
	<a href="#_how_can_i_update_the_whitelabelname_plugin_in_my_store">
		<span class="item-number">8.1</span>
		<span class="item-title">How can I update the wallee plugin in my store?</span>
			</a>
    </li>    		    			<li class="nav-level-2">
	<a href="#_how_to_prevent_paypal_payments_processed_through_whitelabelname_from_being_registered_twice">
		<span class="item-number">8.2</span>
		<span class="item-title">How to prevent PayPal payments processed through wallee from being registered twice?</span>
			</a>
    </li>    		    	</ul>
    </li>					<li class="nav-level-1">
	<a href="#_support">
		<span class="item-number">9</span>
		<span class="item-title">Support</span>
			</a>
    </li>			</ul>
</div>					</div>
	</div>
				</div>
					</div>

		<script type="text/javascript" src="assets/jquery.js"></script>
		<script type="text/javascript" src="assets/scrollspy.js"></script>
		<script type="text/javascript" src="assets/sticky-kit.js"></script>
		<script type="text/javascript" src="assets/highlight.js"></script>
		<script type="text/javascript" src="assets/base.js"></script>
	</body>
</html>
